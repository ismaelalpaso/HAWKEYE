{"ast":null,"code":"// src/api/auth.js\nexport async function login(username, password) {\n  const response = await fetch('http://localhost:8000/api/auth/login/', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Login failed');\n  }\n  const data = await response.json();\n  // Guarda el token\n  localStorage.setItem('access_token', data.access);\n  localStorage.setItem('refresh_token', data.refresh);\n  return data;\n}\nexport async function refreshToken() {\n  const refresh = localStorage.getItem('refresh_token');\n  if (!refresh) return null;\n  const response = await fetch('http://localhost:8000/api/auth/refresh/', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      refresh\n    })\n  });\n  if (!response.ok) {\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n    return null;\n  }\n  const data = await response.json();\n  localStorage.setItem('access_token', data.access);\n  return data.access;\n}\nexport async function authFetch(url, options = {}) {\n  let token = localStorage.getItem('access_token');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...options.headers\n  };\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n  let response = await fetch(url, {\n    ...options,\n    headers\n  });\n  if (response.status === 401) {\n    // Token posiblemente expirado, intentar refresh\n    token = await refreshToken();\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n      response = await fetch(url, {\n        ...options,\n        headers\n      });\n    } else {\n      // No se pudo refrescar token, forzar logout\n      localStorage.removeItem('access_token');\n      localStorage.removeItem('refresh_token');\n      window.location.href = '/login';\n      return null;\n    }\n  }\n  return response;\n}","map":{"version":3,"names":["login","username","password","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","localStorage","setItem","access","refresh","refreshToken","getItem","removeItem","authFetch","url","options","token","status","window","location","href"],"sources":["C:/Users/ismaa/Desktop/HAWKEYE_SOFTWARE/hawkeye_backend/frontend/src/components/api/auth.js"],"sourcesContent":["// src/api/auth.js\r\nexport async function login(username, password) {\r\n  const response = await fetch('http://localhost:8000/api/auth/login/', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ username, password })\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Login failed');\r\n  }\r\n\r\n  const data = await response.json();\r\n  // Guarda el token\r\n  localStorage.setItem('access_token', data.access);\r\n  localStorage.setItem('refresh_token', data.refresh);\r\n  return data;\r\n}\r\n\r\nexport async function refreshToken() {\r\n  const refresh = localStorage.getItem('refresh_token');\r\n  if (!refresh) return null;\r\n\r\n  const response = await fetch('http://localhost:8000/api/auth/refresh/', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ refresh }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    localStorage.removeItem('access_token');\r\n    localStorage.removeItem('refresh_token');\r\n    return null;\r\n  }\r\n\r\n  const data = await response.json();\r\n  localStorage.setItem('access_token', data.access);\r\n  return data.access;\r\n}\r\n\r\nexport async function authFetch(url, options = {}) {\r\n  let token = localStorage.getItem('access_token');\r\n  let headers = { 'Content-Type': 'application/json', ...options.headers };\r\n\r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n\r\n  let response = await fetch(url, { ...options, headers });\r\n\r\n  if (response.status === 401) {\r\n    // Token posiblemente expirado, intentar refresh\r\n    token = await refreshToken();\r\n    if (token) {\r\n      headers['Authorization'] = `Bearer ${token}`;\r\n      response = await fetch(url, { ...options, headers });\r\n    } else {\r\n      // No se pudo refrescar token, forzar logout\r\n      localStorage.removeItem('access_token');\r\n      localStorage.removeItem('refresh_token');\r\n      window.location.href = '/login';\r\n      return null;\r\n    }\r\n  }\r\n\r\n  return response;\r\n}\r\n"],"mappings":"AAAA;AACA,OAAO,eAAeA,KAAKA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;EAC9C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,uCAAuC,EAAE;IACpEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACP,cAAc,EAAE;IAClB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAER,QAAQ;MAAEC;IAAS,CAAC;EAC7C,CAAC,CAAC;EAEF,IAAI,CAACC,QAAQ,CAACO,EAAE,EAAE;IAChB,MAAM,IAAIC,KAAK,CAAC,cAAc,CAAC;EACjC;EAEA,MAAMC,IAAI,GAAG,MAAMT,QAAQ,CAACU,IAAI,CAAC,CAAC;EAClC;EACAC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEH,IAAI,CAACI,MAAM,CAAC;EACjDF,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEH,IAAI,CAACK,OAAO,CAAC;EACnD,OAAOL,IAAI;AACb;AAEA,OAAO,eAAeM,YAAYA,CAAA,EAAG;EACnC,MAAMD,OAAO,GAAGH,YAAY,CAACK,OAAO,CAAC,eAAe,CAAC;EACrD,IAAI,CAACF,OAAO,EAAE,OAAO,IAAI;EAEzB,MAAMd,QAAQ,GAAG,MAAMC,KAAK,CAAC,yCAAyC,EAAE;IACtEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEQ;IAAQ,CAAC;EAClC,CAAC,CAAC;EAEF,IAAI,CAACd,QAAQ,CAACO,EAAE,EAAE;IAChBI,YAAY,CAACM,UAAU,CAAC,cAAc,CAAC;IACvCN,YAAY,CAACM,UAAU,CAAC,eAAe,CAAC;IACxC,OAAO,IAAI;EACb;EAEA,MAAMR,IAAI,GAAG,MAAMT,QAAQ,CAACU,IAAI,CAAC,CAAC;EAClCC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEH,IAAI,CAACI,MAAM,CAAC;EACjD,OAAOJ,IAAI,CAACI,MAAM;AACpB;AAEA,OAAO,eAAeK,SAASA,CAACC,GAAG,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;EACjD,IAAIC,KAAK,GAAGV,YAAY,CAACK,OAAO,CAAC,cAAc,CAAC;EAChD,IAAIb,OAAO,GAAG;IAAE,cAAc,EAAE,kBAAkB;IAAE,GAAGiB,OAAO,CAACjB;EAAQ,CAAC;EAExE,IAAIkB,KAAK,EAAE;IACTlB,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUkB,KAAK,EAAE;EAC9C;EAEA,IAAIrB,QAAQ,GAAG,MAAMC,KAAK,CAACkB,GAAG,EAAE;IAAE,GAAGC,OAAO;IAAEjB;EAAQ,CAAC,CAAC;EAExD,IAAIH,QAAQ,CAACsB,MAAM,KAAK,GAAG,EAAE;IAC3B;IACAD,KAAK,GAAG,MAAMN,YAAY,CAAC,CAAC;IAC5B,IAAIM,KAAK,EAAE;MACTlB,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUkB,KAAK,EAAE;MAC5CrB,QAAQ,GAAG,MAAMC,KAAK,CAACkB,GAAG,EAAE;QAAE,GAAGC,OAAO;QAAEjB;MAAQ,CAAC,CAAC;IACtD,CAAC,MAAM;MACL;MACAQ,YAAY,CAACM,UAAU,CAAC,cAAc,CAAC;MACvCN,YAAY,CAACM,UAAU,CAAC,eAAe,CAAC;MACxCM,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MAC/B,OAAO,IAAI;IACb;EACF;EAEA,OAAOzB,QAAQ;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}